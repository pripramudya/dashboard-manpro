{
    "collab_server" : "",
    "contents" : "library(shinydashboard)\nlibrary(shinyBS)\n\nfunction(input, output, session) {\n\n  # Modal for telkom akses project\n  lapply(\n    1:length(telkomakses$NO_KONTRAK), \n    function(i) {  \n      observeEvent(input[[paste0(\"click\", i)]], {\n        \n        # Info Prohect Modal \n        output[[paste0(\"project.table\", i)]] <- \n          renderTable({\n            matrix(\n              data = c(\"Nama Proyek\", \"Mitra\", \"TReg\", \"Total STO\", \n                       \"Nilai Proyek / Belum BAST-1\", \"EDC --- TOC\",\n                       \"Total Lokasi / On Going / Lag\",\n                       \": \", \": \",\": \",\": \",\": \", \": \",\": \",\n                       telkomakses$NM_PROYEK[i], telkomakses$NM_VENDOR[i], telkomakses$reg[i],\n                       telkomakses$sto[i],\n                       paste0(\n                         formatC(\n                           telkomakses$nilai[i], big.mark = \".\", decimal.mark = \",\", \n                           format = \"f\", drop0trailing = TRUE\n                         ), \" / \",\n                         formatC(\n                           telkomakses$ny.bast[i], big.mark = \".\", decimal.mark = \",\", \n                           format = \"f\", drop0trailing = TRUE\n                         )\n                       ),\n                       paste0(telkomakses$edc[i], \" --- \", telkomakses$toc[i]), \n                       paste0(\n                         telkomakses$location[i], \" / \",\n                         telkomakses$og.location[i], \" / \", telkomakses$lag.location[i]\n                       )\n              ),\n              nrow = 7,\n              ncol = 3\n            )\n          }, colnames = FALSE, spacing = \"xs\"\n          )\n        \n        # Progress Bar modal\n        output[[paste0(\"progress.bar\", i)]] <- \n          renderPlot({\n            telkomakses %>% \n              filter(NO_KONTRAK == telkomakses$NO_KONTRAK[i]) %>%\n              ggplot(aes(x = NO_KONTRAK, y = progress)) + \n              scale_y_continuous(breaks = round(telkomakses$progress[i]), \n                                 sec.axis = dup_axis(breaks = telkomakses$plan[i])) +\n              scale_x_discrete(labels = \"PROGRESS\") +\n              geom_bar(stat = \"identity\") + expand_limits(y = c(0, 100))  +\n              geom_hline(yintercept= telkomakses$plan[i], size = 2) + \n              geom_hline(yintercept= 0, size = 0.5) + \n              geom_hline(yintercept= 100, size = 0.5) +\n              coord_flip() + theme_bw() +\n              theme(panel.grid.major = element_blank(), \n                    panel.grid.minor = element_blank(), \n                    panel.border = element_blank(),\n                    axis.title = element_blank(), \n                    axis.ticks = element_blank()\n              )\n          })          \n        \n        # Sttus Bar Modal\n        output[[paste0(\"status.bar\", i)]] <- \n          renderPlot({\n            raw_projects %>% \n              filter(NO_KONTRAK == telkomakses$NO_KONTRAK[i]) %>%\n              ggplot(aes(x = STATUS, y = NIKON)) + \n              geom_bar(stat = \"identity\") + \n              scale_x_discrete(limits = rev(c(\"PREPARING\", \n                                              \"DELIVERY\", \"INSTALLASI\", \"TEST COMM\", \"UJI TERIMA\", \n                                              \"BAST-1\"))) +\n              coord_flip() + theme_bw() +\n              theme(panel.grid.major = element_blank(), \n                    panel.grid.minor = element_blank(), \n                    panel.border = element_blank(),\n                    axis.title = element_blank(), \n                    axis.text.x = element_blank(),\n                    axis.ticks = element_blank()\n              )\n          })\n      })  \n    })    \n\n  # Modal for non telkom akses project\n  lapply(\n    1:length(nontelkomakses$NO_KONTRAK), \n    function(i) {  \n      observeEvent(input[[paste0(\"aclick\", i)]], {\n        \n        # Info Prohect Modal \n        output[[paste0(\"aproject.table\", i)]] <- \n          renderTable({\n            matrix(\n              data = c(\"Nama Proyek\", \"Mitra\", \"TReg\", \"Total STO\", \n                       \"Nilai Proyek / Belum BAST-1\", \"EDC --- TOC\",\n                       \"Total Lokasi / On Going / Lag\",\n                       \": \", \": \",\": \",\": \",\": \", \": \",\": \",\n                       nontelkomakses$NM_PROYEK[i], nontelkomakses$NM_VENDOR[i], nontelkomakses$reg[i],\n                       nontelkomakses$sto[i],\n                       paste0(\n                         formatC(\n                           nontelkomakses$nilai[i], big.mark = \".\", decimal.mark = \",\", \n                           format = \"f\", drop0trailing = TRUE\n                         ), \" / \",\n                         formatC(\n                           nontelkomakses$ny.bast[i], big.mark = \".\", decimal.mark = \",\", \n                           format = \"f\", drop0trailing = TRUE\n                         )\n                       ),\n                       paste0(nontelkomakses$edc[i], \" --- \", nontelkomakses$toc[i]), \n                       paste0(\n                         nontelkomakses$location[i], \" / \",\n                         nontelkomakses$og.location[i], \" / \", nontelkomakses$lag.location[i]\n                       )\n              ),\n              nrow = 7,\n              ncol = 3\n            )\n          }, colnames = FALSE, spacing = \"xs\"\n          )\n        \n        # Progress Bar modal\n        output[[paste0(\"aprogress.bar\", i)]] <- \n          renderPlot({\n            nontelkomakses %>% \n              filter(NO_KONTRAK == nontelkomakses$NO_KONTRAK[i]) %>%\n              ggplot(aes(x = NO_KONTRAK, y = progress)) + \n              scale_y_continuous(breaks = round(nontelkomakses$progress[i]), \n                                 sec.axis = dup_axis(breaks = nontelkomakses$plan[i])) +\n              scale_x_discrete(labels = \"PROGRESS\") +\n              geom_bar(stat = \"identity\") + expand_limits(y = c(0, 100))  +\n              geom_hline(yintercept= nontelkomakses$plan[i], size = 2) + \n              geom_hline(yintercept= 0, size = 0.5) + \n              geom_hline(yintercept= 100, size = 0.5) +\n              coord_flip() + theme_bw() +\n              theme(panel.grid.major = element_blank(), \n                    panel.grid.minor = element_blank(), \n                    panel.border = element_blank(),\n                    axis.title = element_blank(), \n                    axis.ticks = element_blank()\n              )\n          })          \n        \n        # Sttus Bar Modal\n        output[[paste0(\"astatus.bar\", i)]] <- \n          renderPlot({\n            raw_projects %>% \n              filter(NO_KONTRAK == nontelkomakses$NO_KONTRAK[i]) %>%\n              ggplot(aes(x = STATUS, y = NIKON)) + \n              geom_bar(stat = \"identity\") + \n              scale_x_discrete(limits = rev(c(\"PREPARING\", \n                                              \"DELIVERY\", \"INSTALLASI\", \"TEST COMM\", \"UJI TERIMA\", \n                                              \"BAST-1\"))) +\n              coord_flip() + theme_bw() +\n              theme(panel.grid.major = element_blank(), \n                    panel.grid.minor = element_blank(), \n                    panel.border = element_blank(),\n                    axis.title = element_blank(), \n                    axis.text.x = element_blank(),\n                    axis.ticks = element_blank()\n              )\n          })\n      })  \n    })    \n\n}\n\n\n\n",
    "created" : 1509262423613.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1977355104",
    "id" : "7D5EA316",
    "lastKnownWriteTime" : 1513351489,
    "last_content_update" : 1513351489759,
    "path" : "D:/Pram Doc/Learning R/learning shinydashboard/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}